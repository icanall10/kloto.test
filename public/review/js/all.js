!function(e){function r(){e(".review-stars-form .stars").once("review-stars-form-stars").on("getRating",(function(){let r=e(this).find(".star");for(const t in r){if(!(t>=0))continue;if(!e(r[t]).hasClass("enabled"))return t}return 5})).on("enableHoverPriority",(function(){e(this).addClass("hover-priority")})).on("disableHoverPriority",(function(){e(this).removeClass("hover-priority")})),e(".review-stars-form .stars .star").once("review-stars-form-star").on("updateClass",(function(r,t,o){let s=e(this).closest(".stars").find(".star");if(s.removeClass(o),t)for(const r in s){if(!(r>=0))continue;let t=e(s[r]);if(t.addClass(o),t[0]===this)break}})).hover((function(){let r=e(this);r.closest(".stars").trigger("enableHoverPriority"),r.trigger("updateClass",[!0,"hover"])}),(function(){let r=e(this);r.closest(".stars").trigger("disableHoverPriority"),r.trigger("updateClass",[!1,"hover"])})).click((function(){let r=e(this),t=r.closest(".stars"),o=r.closest("form");t.trigger("disableHoverPriority"),r.trigger("updateClass",[!0,"enabled"]),o.find('input[name="rating"]').val(t.triggerHandler("getRating"))})),e(".review-stars-form").once("review-stars-form").on("setError",(function(r,t){e(this).find(".error").html(t)})),e('.review-stars-form button[type="submit"]').once("review-stars-form-submit").click((function(r){r.preventDefault();let t=e(this).closest("form"),o=parseInt(t.find('input[name="rating"]').val());if(t.removeClass("has-error"),!o)return t.addClass("has-error"),void t.trigger("setError","Нужно поставить оценку");o<=3?e(".review-modal").trigger("open"):top.location.href=t.attr("data-good-rating-url")})),e(".review-director-form").once("review-director-for").on("setError",(function(r,t){e(this).find(".error").html(t)})),e('.review-director-form button[type="submit"]').once("review-director-form-submit").click((function(r){r.preventDefault();let t=e(this).closest("form"),o=t.find('textarea[name="text"]').val()||"";if(t.removeClass("has-error"),0===o.length)return t.addClass("has-error"),void t.trigger("setError","Напишите, пожалуйста, что мы можем улучшить");e.ajax({url:"/review/director.php",method:"post",data:t.serialize(),success:function(e){t.addClass("completed")}})})),e(".review-modal").once("review-modal").on("open",(function(){e(this).addClass("open")})).on("close",(function(){e(this).removeClass("open")})),e(".review-modal-close").once("review-modal-close").click((function(r){r.preventDefault(),e(this).closest(".review-modal").trigger("close")}))}e(document).ready((function(){r()})),e(document).ajaxComplete((function(){r()}))}(jQuery);
